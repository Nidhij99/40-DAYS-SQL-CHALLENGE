Create database microsoft;
use microsoft;
CREATE TABLE Employees (
    id INT,          
    name VARCHAR(100) NOT NULL,     
    salary NUMERIC(10, 2),         
    department_id INT,              
    manager_id INT,                 
    hire_date DATE NOT NULL        
);

-- Insert data into Employees table with manually assigned IDs
INSERT INTO Employees (id, name, salary, department_id, manager_id, hire_date)
VALUES 
(1, 'Alice', 90000, 1, NULL, '2022-01-15'),    
(2, 'Bob', 80000, 2, 1, '2022-02-20'),        
(3, 'Charlie', 75000, 2, 1, '2022-03-12'),     
(4, 'David', 85000, 2, 1, '2022-03-25'),       
(5, 'Eve', 95000, 2, 2, '2022-04-01'),         
(6, 'Frank', 78000, 2, 2, '2022-04-20'),       
(7, 'Grace', 60000, 3, 3, '2022-05-12'),       
(8, 'Heidi', 88000, 3, 1, '2022-06-15'),       
(7, 'Grace', 60000, 3, 3, '2022-05-12'),       
(7, 'Grace', 60000, 3, 3, '2022-05-12');      

-- Q5. Delete Duplicate Records but make sure to keep the distinct records.

with cte as(                                 -- important question
select *, row_number() over(partition by id, name, salary,department-id, manager_id, hire_date order by id) as rn from employees)
delete from employees 
where id in (select id from cte where rn>1);
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
